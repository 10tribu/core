<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article PUBLIC "-//OASIS//DTD DocBook XML V4.5//EN" "http://www.oasis-open.org/docbook/xml/4.5/docbookx.dtd">
<?asciidoc-toc?>
<?asciidoc-numbered?>

<article lang="en">
<articleinfo>
    <title>Mise à jour</title>
</articleinfo>
<section id="_centre_de_mise_à_jour">
<title>Centre de mise à jour</title>
<simpara>Le centre de mise à jour centralise l&#8217;ensemble des fonctions de Jeedom, et permet de mettre à jour toutes les fonctionnalités de Jeedom, incluant le logiciel de base, les plugins, les widgets, etc&#8230;</simpara>
<simpara>Il est accessible par le menu Administration &#8594; Centre de mise à jour :</simpara>
<informalfigure>
<mediaobject>
  <imageobject>
  <imagedata fileref="../images/update.JPG"/>
  </imageobject>
  <textobject><phrase>../images/update.JPG</phrase></textobject>
</mediaobject>
</informalfigure>
<simpara>Une fois dessus vous obtenez :</simpara>
<informalfigure>
<mediaobject>
  <imageobject>
  <imagedata fileref="../images/update2.png"/>
  </imageobject>
  <textobject><phrase>../images/update2.png</phrase></textobject>
</mediaobject>
</informalfigure>
<simpara>Il présente sous forme de tableau l&#8217;ensemble des éléments installés dans Jeedom.</simpara>
<tip><simpara>En mode Expert, on affiche tous les élements, si non, on affiche uniquement les éléments à mettre à jour.</simpara></tip>
<simpara>Il y a au total jusqu'à 5 boutons qui peuvent être disponibles par élément :</simpara>
<itemizedlist>
<listitem>
<simpara>
<emphasis role="strong">Voir</emphasis> : permet de consulter la page du Market correspondant à l'élément sélectionné
</simpara>
</listitem>
<listitem>
<simpara>
<emphasis role="strong">Partager</emphasis> : permet lorsque vous avez créé un élément de le partager sur le Market
</simpara>
</listitem>
<listitem>
<simpara>
<emphasis role="strong">Supprimer</emphasis> : permet de désinstaller un élément
</simpara>
</listitem>
<listitem>
<simpara>
<emphasis role="strong">Mettre à jour</emphasis> : permet de mettre à jour l'élément
</simpara>
</listitem>
</itemizedlist>
<tip><simpara>A noter que "core:jeedom" signifie la mise à jour du logiciel de base Jeedom.</simpara></tip>
<simpara>En haut du tableau se trouvent les boutons de commande. Jeedom se connecte périodiquement avec le Market pour voir si des mises à jour sont disponibles (la date de dernière vérification est indiquée tout en haut du tableau à gauche). Si vous voulez réaliser une vérification manuelle, vous pouvez appuyer sur le bouton "Vérifier les mises à jour".</simpara>
<simpara>Le bouton "Mettre à jour" permet de mettre à jour l&#8217;ensemble de Jeedom.</simpara>
<informalfigure>
<mediaobject>
  <imageobject>
  <imagedata fileref="../images/update3.png"/>
  </imageobject>
  <textobject><phrase>../images/update3.png</phrase></textobject>
</mediaobject>
</informalfigure>
<tip><simpara>Sur la branche beta le numéro de version n&#8217;est pas toujours mis à jour après chaque modification, il faut donc cliquer sur "Mettre à jour" régulièrement pour être sur d&#8217;avoir la dernière version. Ce n&#8217;est le cas bien sûr que sur la branche beta.</simpara></tip>
<important><simpara>Avant une mise à jour, Jeedom va par défaut faire une sauvegarde. En cas de souci lors de l&#8217;application d&#8217;une mise à jour, Jeedom va automatiquement restaurer la sauvegarde faite juste avant. Ce principe n&#8217;est bien sûr valable que pour les mises à jour de Jeedom et non des plugins.</simpara></important>
<simpara>En cliquant sur la flêche à côté du bouton "Mettre à jour" on a un certain nombre d&#8217;options de mise à jour.</simpara>
<informalfigure>
<mediaobject>
  <imageobject>
  <imagedata fileref="../images/update5.png"/>
  </imageobject>
  <textobject><phrase>../images/update5.png</phrase></textobject>
</mediaobject>
</informalfigure>
<itemizedlist>
<listitem>
<simpara>
<emphasis role="strong">Tout forcer</emphasis> : met à jour Jeedom et les plugins en mode forcé c&#8217;est-à-dire que même s&#8217;il y a une erreur Jeedom continue et ne restaurera pas la sauvegarde
</simpara>
</listitem>
<listitem>
<simpara>
<emphasis role="strong">Plugins seulement</emphasis> : met à jour seulement les plugins
</simpara>
</listitem>
<listitem>
<simpara>
<emphasis role="strong">Plugins seulement forcés</emphasis> : met à jour seulement les plugins en mode forcé (continue en cas d&#8217;erreur)
</simpara>
</listitem>
<listitem>
<simpara>
<emphasis role="strong">Jeedom seulement</emphasis> : met à jour seulement Jeedom
</simpara>
</listitem>
<listitem>
<simpara>
<emphasis role="strong">Jeedom seulement forcés</emphasis> : met à jour seulement Jeedom en mode forcé c&#8217;est-à-dire que même s&#8217;il y a une erreur Jeedom continue et ne restaurera pas la sauvegarde
</simpara>
</listitem>
<listitem>
<simpara>
<emphasis role="strong">Réappliquer une mise à jour</emphasis> : permet de réappliquer une mise à jour. Toutes les mises à jour ne peuvent être réappliquées. En cliquant dessus vous obtenez cette fenêtre :
</simpara>
</listitem>
</itemizedlist>
<informalfigure>
<mediaobject>
  <imageobject>
  <imagedata fileref="../images/update6.png"/>
  </imageobject>
  <textobject><phrase>../images/update6.png</phrase></textobject>
</mediaobject>
</informalfigure>
<simpara>Ici vous choisissez d&#8217;abord la mise à jour à réappliquer, si c&#8217;est en mode forcé ou non (vivement conseillé dans ce cas là) et s&#8217;il faut aussi appliquer les mises à jour suivantes (vivement conseillé aussi).</simpara>
<simpara>Enfin à droite de la page, la partie "Informations" permet de suivre l'état de la mise à jour.
Ces informations sont à communiquer à l'équipe en cas de problème.</simpara>
<informalfigure>
<mediaobject>
  <imageobject>
  <imagedata fileref="../images/update4.png"/>
  </imageobject>
  <textobject><phrase>../images/update4.png</phrase></textobject>
</mediaobject>
</informalfigure>
</section>
<section id="_paramètres_de_mise_à_jour">
<title>Paramètres de mise à jour</title>
<simpara>Il est possible dans Administration &#8594; Configuration puis dans la partie "Market et mise à jour" de configurer certains paramètres de mise à jour :</simpara>
<informalfigure>
<mediaobject>
  <imageobject>
  <imagedata fileref="../images/administration10.png"/>
  </imageobject>
  <textobject><phrase>../images/administration10.png</phrase></textobject>
</mediaobject>
</informalfigure>
<simpara>Ici on retrouve :</simpara>
<itemizedlist>
<listitem>
<simpara>
<emphasis role="strong">Adresse</emphasis> : adresse du Market, à ne surtout jamais changer à moins que cela soit sur demande de l'équipe de support
</simpara>
</listitem>
<listitem>
<simpara>
<emphasis role="strong">Nom d&#8217;utilisateur</emphasis> : nom d&#8217;utilisateur du Market
</simpara>
</listitem>
<listitem>
<simpara>
<emphasis role="strong">Mot de passe</emphasis> : mot de passe du Market
</simpara>
</listitem>
<listitem>
<simpara>
<emphasis role="strong">Installer automatiquement les widgets manquants</emphasis> : indique à Jeedom d&#8217;installer automatiquement les widgets dont il a besoin (attention à bien avoir installé le plugin Widget)
</simpara>
</listitem>
<listitem>
<simpara>
<emphasis role="strong">Voir les modules en beta (à vos risques et périls)</emphasis> : Permet de voir les plugins, widgets&#8230; qui sont en beta et de les installer
</simpara>
</listitem>
<listitem>
<simpara>
<emphasis role="strong">Faire une sauvegarde avant la mise à jour</emphasis> : indique à Jeedom de faire une sauvegarde avant chaque mise à jour (vivement recommandé)
</simpara>
</listitem>
<listitem>
<simpara>
<emphasis role="strong">Mettre à jour automatiquement</emphasis> : indique à Jeedom d&#8217;installer automatiquement les mises à jour (non recommandé)
</simpara>
</listitem>
<listitem>
<simpara>
<emphasis role="strong">Branche</emphasis> : indique la version de Jeedom à utiliser soit en stable soit en développement (beta)
</simpara>
</listitem>
</itemizedlist>
<important><simpara>Il faut éviter de mélanger les plugins beta avec un Jeedom stable et vise versa. De nombreuses erreurs sont remontées à l'équipe de support car cette règle n&#8217;est pas respectée.</simpara></important>
<important><simpara>Il n&#8217;est pas possible de choisir l&#8217;heure de la vérification des mises à jour ou le moment de la mise à jour en automatique, cela pour permettre une répartition des demandes sur le Market. A noter toutefois que ces deux actions ont forcément lieu entre 6h00 et 7h59.</simpara></important>
</section>
<section id="_mise_à_jour_en_ligne_de_commande">
<title>Mise à jour en ligne de commande</title>
<simpara>Il est possible de faire une mise à jour de Jeedom directement en SSH, voici comment faire :</simpara>
<screen>sudo php /usr/share/nginx/www/jeedom/install/install.php</screen>
<simpara>Voilà les paramètres possibles :</simpara>
<itemizedlist>
<listitem>
<simpara>
<emphasis role="strong">mode</emphasis> : force, pour lancer une mise à jour en mode forcé (ne tiens pas compte des erreurs)
</simpara>
</listitem>
<listitem>
<simpara>
<emphasis role="strong">version</emphasis> : numéro de version, pour réapliquer les changements depuis cette version
</simpara>
</listitem>
</itemizedlist>
<simpara>Exemple pour faire une mise à jour forcée en réappliquant les changements depuis la 1.188.0 :</simpara>
<screen>sudo php /usr/share/nginx/www/jeedom/install/install.php mode=force version=1.188.0</screen>
<simpara>Attention, après une mise à jour en ligne de commande, il faut réappliquer les droits sur le dossier Jeedom :</simpara>
<screen>chown -R www-data:www-data /usr/share/nginx/www/jeedom</screen>
</section>
</article>
