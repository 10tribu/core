<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article PUBLIC "-//OASIS//DTD DocBook XML V4.5//EN" "http://www.oasis-open.org/docbook/xml/4.5/docbookx.dtd">
<?asciidoc-toc?>
<?asciidoc-numbered?>

<article lang="en">
<articleinfo>
    <title>Sauvegarde et restauration</title>
</articleinfo>
<simpara>La sauvegarde et restauration de Jeedom permet de sauvegarder celui-ci et de le restaurer sur lui-même ou sur un autre Jeedom.</simpara>
<section id="_configuration">
<title>Configuration</title>
<simpara>Accessible depuis Administration &#8594; Sauvegarde :</simpara>
<informalfigure>
<mediaobject>
  <imageobject>
  <imagedata fileref="../images/backup.png"/>
  </imageobject>
  <textobject><phrase>../images/backup.png</phrase></textobject>
</mediaobject>
</informalfigure>
<simpara>Cette page permet la gestion des sauvegardes :</simpara>
<informalfigure>
<mediaobject>
  <imageobject>
  <imagedata fileref="../images/backup2.png"/>
  </imageobject>
  <textobject><phrase>../images/backup2.png</phrase></textobject>
</mediaobject>
</informalfigure>
<simpara>Sur cette page vous retrouvez à gauche les paramètres et les boutons d&#8217;action, et à droite le statut en temps réel de l&#8217;action en cours (sauvegarde en cours ou restauration), si vous en avez lancée une.</simpara>
<simpara>Sur la gauche on a :</simpara>
<itemizedlist>
<listitem>
<simpara>
<emphasis role="strong">Sauvegardes</emphasis>
</simpara>
<itemizedlist>
<listitem>
<simpara>
<emphasis role="strong">Sauvegarde</emphasis> : permet de lancer une sauvegarde immédiatement (utile si vous voulez faire un changement critique, cela vous permettra de revenir en arrière). Vous avez aussi un bouton pour lancer une sauvegarde sans envoyer l&#8217;archive sur le cloud (nécessite un abonnement voir plus bas), l&#8217;envoi de l&#8217;archive peut prendre du temps cela permet donc d&#8217;en gagner un peu.
</simpara>
</listitem>
<listitem>
<simpara>
<emphasis role="strong">Emplacement des sauvegardes</emphasis> : endroit où Jeedom met les sauvegardes, il est recommandé de ne pas le changer. Si vous êtes en chemin relatif, alors son origine est l&#8217;endroit ou Jeedom est installé (/usr/share/nginx/www/jeedom).
</simpara>
</listitem>
<listitem>
<simpara>
<emphasis role="strong">Nombre de jour(s) de mémorisation des sauvegardes</emphasis> : nombre de jours de sauvegarde à garder. Une fois ce délai passé les sauvegardes sont supprimées. Attention à ne pas mettre un nombre de jours trop élevé, sinon vous pouvez remplir votre système de fichiers.
</simpara>
</listitem>
<listitem>
<simpara>
<emphasis role="strong">Taille totale maximale des backups (Mo)</emphasis> : Permet de limiter la taille totale des sauvegardes. Si cette valeur est dépassée alors Jeedom va supprimer les sauvegardes les plus vieilles jusqu'à retomber en-dessous de la taille maximale.
</simpara>
</listitem>
<listitem>
<simpara>
<emphasis role="strong">Envoyer les sauvegardes dans le cloud</emphasis> : indique à Jeedom d&#8217;envoyer les sauvegardes au Market, attention il faut avoir pris l&#8217;abonnement.
</simpara>
</listitem>
</itemizedlist>
</listitem>
<listitem>
<simpara>
<emphasis role="strong">Sauvegardes locales</emphasis>
</simpara>
<itemizedlist>
<listitem>
<simpara>
<emphasis role="strong">Sauvegardes disponibles</emphasis> : liste des sauvegardes disponibles
</simpara>
</listitem>
<listitem>
<simpara>
<emphasis role="strong">Restaurer la sauvegarde</emphasis> : lance la restauration de la sauvegarde sélectionnée au-dessus
</simpara>
</listitem>
<listitem>
<simpara>
<emphasis role="strong">Supprimer la sauvegarde</emphasis> : supprime la sauvegarde sélectionnée au-dessus
</simpara>
</listitem>
<listitem>
<simpara>
<emphasis role="strong">Envoyer une sauvegarde</emphasis> : vous permet d&#8217;envoyer à Jeedom une archive de sauvegarde (permet par exemple de restaurer une archive précédemment récupérée sur un nouveau Jeedom ou une réinstallation)
</simpara>
</listitem>
<listitem>
<simpara>
<emphasis role="strong">Télécharger la sauvegarde</emphasis> : vous permet de récupérer l&#8217;archive de la sauvegarde sélectionnée au-dessus
</simpara>
</listitem>
</itemizedlist>
</listitem>
<listitem>
<simpara>
<emphasis role="strong">Sauvegardes cloud</emphasis>
</simpara>
<itemizedlist>
<listitem>
<simpara>
<emphasis role="strong">Sauvegardes disponibles</emphasis> : liste des sauvegardes cloud disponibles
</simpara>
</listitem>
<listitem>
<simpara>
<emphasis role="strong">Restaurer la sauvegarde</emphasis> : lance la restauration d&#8217;une sauvegarde cloud
</simpara>
</listitem>
</itemizedlist>
</listitem>
</itemizedlist>
<tip><simpara>Lors d&#8217;une réinstallation de Jeedom et en ayant pris l&#8217;abonnement de sauvegarde cloud, vous avez juste sur votre nouveau Jeedom à renseigner votre compte Market puis à venir ici pour lancer la restauration.</simpara></tip>
<tip><simpara>Il est possible, en cas de soucis, de faire un backup en ligne de commandes : <literal>sudo php /usr/share/nginx/www/jeedom/install/backup.php</literal></simpara></tip>
<tip><simpara>Il est possible aussi de restaurer un backup en ligne de commandes (par défaut Jeedom restaure le backup le plus récent présent dans le répertoire de backup) : <literal>sudo php /usr/share/nginx/www/jeedom/install/restore.php</literal></simpara></tip>
</section>
<section id="_qu_8217_est_ce_qui_est_sauvegardé">
<title>Qu&#8217;est-ce qui est sauvegardé ?</title>
<simpara>Lors d&#8217;une sauvegarde, Jeedom va sauvegarder tous ses fichiers et la base de données. Cela contient donc toute votre configuration (équipement, commande, historique, scénario, design&#8230;).</simpara>
<simpara>Au niveau des protocoles, seul le Z-Wave (OpenZwave) est un peu différent car il n&#8217;est pas possible de sauvegarder les inclusions. Celles-ci sont directement incluses dans le contrôleur, il faut donc garder le même pour tout retrouver.</simpara>
</section>
<section id="_sauvegarde_cloud">
<title>Sauvegarde cloud</title>
<simpara>La sauvegarde dans le cloud permet à Jeedom d&#8217;envoyer vos sauvegardes directement sur le Market. Cela vous permet de les restaurer facilement et d'être sûr de ne pas les perdre. Le Market conserve les 14 dernières sauvegardes. Pour vous abonner il suffit d&#8217;aller sur votre page profil sur le Market :</simpara>
<informalfigure>
<mediaobject>
  <imageobject>
  <imagedata fileref="../images/backup3.png"/>
  </imageobject>
  <textobject><phrase>../images/backup3.png</phrase></textobject>
</mediaobject>
</informalfigure>
<simpara>Puis dans l&#8217;onglet mes backups :</simpara>
<informalfigure>
<mediaobject>
  <imageobject>
  <imagedata fileref="../images/backup4.png"/>
  </imageobject>
  <textobject><phrase>../images/backup4.png</phrase></textobject>
</mediaobject>
</informalfigure>
<simpara>Vous pouvez, à partir de cette page, récupérer un backup ou acheter un abonnement (pour 1, 3, 6 ou 12 mois).</simpara>
<tip><simpara>Vous pouvez mettre un nom de sauvegarde plus sympa à partir de l&#8217;onglet "Mes Jeedoms" en donnant un nom à ceux-ci.</simpara></tip>
</section>
<section id="_fréquence_des_backups">
<title>Fréquence des backups</title>
<simpara>Jeedom effectue une sauvegarde tous les jours.Vous pouvez modifier cette heure à partir du "Moteur de tâches" (la tâche est nommée <emphasis>Jeedom backup</emphasis>) mais ce n&#8217;est pas recommandé car cette heure est calculée par rapport à la charge et l&#8217;heure de la sauvegarde du Market.</simpara>
</section>
<section id="_cas_d_8217_un_esclave">
<title>Cas d&#8217;un esclave</title>
<simpara>Le cas d&#8217;un esclave est un peu particulier, car il va après chaque sauvegarde envoyer celle-ci sur son maître (et sur le Market si vous avez un abonnement au service de sauvegarde cloud). Vous pouvez donc à partir du maître récupérer une sauvegarde de l&#8217;esclave pour l&#8217;installer sur un autre esclave par exemple.</simpara>
</section>
</article>
